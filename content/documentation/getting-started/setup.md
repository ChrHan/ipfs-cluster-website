+++
title = "Setup and Initialize"
weight = 20
+++

# Setting up Cluster peers

All IPFS Cluster configuration, identity and persistent data can be found, by default, at the `$HOME/.ipfs-cluster` folder.

In order to setup your Cluster peers you will need to:

* [Initialize the configuration and peer indentity](#initialization)
* [Set the same `secret` in all of them](#the-cluster-secret)
* [Optionally pre-fill the `peerstore` file with other peers multiaddresses](#the-peerstore-file)
* [Optionally customizing additional settings depending on your needs](#running-in-production)

## Initialization

To create and generate a default configuration file, a unique identity for your peer and and empty peerstore file simply run:

```
$ ipfs-cluster-service init
```

This assumes that the `ipfs-cluster-service` command is installed in one of the folders in your `$PATH`.

If all went well, after running this command there will be three different files in `$HOME/.ipfs-cluster`:

* `service.json` contains a default peer configuration. Usually, all peers in a cluster should have exactly the same configuration.
* `identity.json` contains the peer private key and ID. These are unique to each Cluster peer.
* `peerstore` is an empty file used to store the peer addresses of other peers, so that this peer knows where to contact them.


## The Cluster `secret`

The `service.json` file generated by `ipfs-cluster-service init` will have a randomly generated `secret` value in the `cluster` section. For a cluster to work, this value **should be the same in all cluster peers**. This is usually a source of pitfalls since initializing default configurations everywhere results in different random secets.

<div class="tipbox tip">If present, the <code>CLUSTER_SECRET</code> environment value is used when running <code>ipfs-cluster-service init</code> to set the cluster <code>secret</code> value.</div>

## Trusted peers

The `crdt` section of the `service.json` file includes an empty `trusted_peers` array. By default, peers running on crdt-mode trust no other peers, and will ignore any pins submitted by other peers. Thus, you will need to set the `trusted_peers` configuration option appropiately. See the [Security](/documentation/administration/security#the-trusted-peers-in-crdt-mode) section for more information.


## The `peerstore` file


The `peerstore` file will be maintained by the running cluster peer and will be used to store known-peer addresses. However,
you can also pre-fill this file (one line per multiaddress) to help this peer connect to others during its first start. Here is an example:

```text
/dns4/cluster1.domain/tcp/9096/ipfs/QmcQ5XvrSQ4DouNkQyQtEoLczbMr6D9bSenGy6WQUCQUBt
/dns4/cluster2.domain/tcp/9096/ipfs/QmdFBMf9HMDH3eCWrc1U11YCPenC3Uvy9mZQ2BedTyKTDf
/ip4/192.168.1.10/tcp/9096/ipfs/QmSGCzHkz8gC9fNndMtaCZdf9RFtwtbTEEsGo4zkVfcykD
```

## Running in production

If you are planning to run IPFS and IPFS Cluster in production, you should read the specific section on [Settings for production](/documentation/administration/production), which provides a few tips on how to configure your ipfs and cluster peers with the right values for such environments. For more information about firewall configuration and security you can read the [Security](/documenation/administration/security).

### Configuration reference

The [configuration reference](/documentation/administration/configuration) contains detailed information for every configuration section, with extended descriptions of what each value means.
